#汇编

---

#C1基础知识

##1.1汇编语言

*Def*:汇编语言是一种初级语言,是一种面向机器的程序设计语言,它的基本内容是机器语言符号化的描述.

计算机只能接受0或1组成的二进制编码指令和数据.

*例子*

| 机器语言(Hex) | 汇编语言 | 
|---|---|
| A00000H | MOV AL,x|
| 02060100H | ADD AL,y|
| A20200H | MOV z, AL|

编辑程序   汇编程序           连接程序
  |         |                 |
汇编源程序->汇编---->目标代码--->连接-->可执行程序

汇编的特点:

1.和机器指令一一对应

2.是靠近机器的语言

3.效率高

##余下小节

*ps*:汇编是一种面向机器的语言

bit,byte,word,double word基础知识不赘述.

*原码、反码、补码*

原码: 0000 0001  1000 0001

反码: 0111 1110  1111 1110

补码: 0000 0001  1111 1111

*BCD码和8421码*

BCD码:1位十进制数的4位二进制数表示

8421码:4位二进制数的表示,用0000-1001表示0-9,1010-1111不用.

---

#C2 80x86 计算机组织结构

##2.1 80x86计算机的基本结构

                CPU
                |
            总线控制逻辑
                |
       |--------|--------|
       |        |        |
    内存储器   I/O接口 ···I/O接口
                |        |
              存储器     I/O设备

*CPU*:由运算器、控制器、寄存器三部分组成.其主要功能是执行存放在内存储器(内存)中的指令.运算器也称为算术逻辑部件,用来执行指令所要求的算数运算、逻辑运算和数据传送等操作;控制器是控制执行步骤,从内存中取出指令,分析操作代码,完成操作数的存取.

总线:总线是连接计算机各个部件的一组信号线,是信息传送的通道,是由总线控逻辑来协调工作.总线负责传送地址、数据和控制信息,包括数据总线(DB),地址总线(AB),控制总线(CB),三条总线分别负责CPU与内存,外存,外围设备交换信息.

*数据总线*:数据总线是用来传送数据的,CPU与内存,I/O设备之间通过数据总线传送数据,80x86系列的数据总线共有8位,16位,32位和64位.因此在数据传送过程中以这些固定大小传送数据.

8086/8088最大可用内存空间位1MB

*存储器*:存储器是计算机的记忆部件,包括内存(主存)和外部存储器(辅存),它与CPU是通过总线连接的.存储器中存放的是指令和数据.

外围设备:外设,不赘述.

##2.2通用寄存器

80x86CPU的通用寄存器包括:4个32位数据寄存器,2个32位指针寄存器和2个32位变址寄存器.

  8个8位通用寄存器:AL AH BL BH CL CH DL DH

  8个16位通用寄存器:AX BX CX DX SI DI BP SP

  8个32位通用寄存器:EAX EBX ECX EDX ESI EDI EBP ESP

80386以上型号的CPU有8个32位通用寄存器、它们是相应的16位通用寄存器AX、BX、CX、DX、SI、DI、BP、SP 的拓展 分别被命名为EAX EBX ECX EDX ESI EDI EBP ESP

AX EAX 累加器

BX EBX 基址寄存器

ECX CX 计数器

EDX DX 数据寄存器

ESP SP 堆栈指针计数器

EBP BP 基址指针寄存器

ESI SI 源变址寄存器

EDI DI 目的变址寄存器

数据寄存器:AX BX CX DX EAX EBX ECX EDX

指针寄存器:SP ESP BP EBP

变址寄存器:SI ESI DI EDII

控制寄存器:FLAGS-----CF(进位) PF(奇偶) AF(辅助进位) ZF(运算结果为0) SF(符号标识)  OF(溢出) DF(方向) IF(中断) TF(单步跟踪)

*段寄存器*:PC中段寄存器采取分段管理的方法来组织数据,代码和数据是分开存放的,代码放在代码段中,数据放在数据段中.所谓的段(Segment)就是在内存中定义的一篇存储空间,因此某个存储但愿能的物理地址需要段的基地址和偏移地址表示.

##2.3 内存组织结构

*内存地址*:在存储器中内存单元的基本单位为字节,每个字节都有一个唯一的地址.

字的地址:字由两个字节组成.

*存储单元的内容*:地址0002H的内容为34H,表示为(0002H) = 34H

**堆栈(Stack)** 是内存中的一块特定区域,是一个常用的数据结构,按照“先入先出”的原则进行操作(FIFO).

##2.4 80x86CPU的工作模式

*Real Mode*

80286以上的微机处器都工作在实模式或保护模式下,只有8086/8088工作在实模式下,且只能寻址1MB空间.

8086/8088最大可寻址地址空间为1MB,但包含在指令中的段地址寄存器(DS CS SS ES) 指针寄存器IP 变址寄存器(SI DI)均是16位,16位寄存器不能存放20位地址,所以其实际寻址空间为64KB.

1MB的物理地址范围:00000H-FFFFFH

64KB的物理地址范围:0000H-FFFFH

物理地址 = 段地址 * 16D(或10H) + 偏移地址

*物理地址*:与内存单元一一对应的20位二进制数(或5位十六进制数)表示的地址为物理地址.

1MB = 00000H - FFFFFH

*段地址*:将1MB的内存空间分成长为64KB的程序区和数据区成为段,每个段用1个16位二进制地址表示.

*段内地址*:16位二进制地址为偏移地址.

*逻辑地址*:用段地址和偏移地址来表示内存单元的地址为逻辑地址,两地址用“:”隔开.例如物理地址为00001H,逻辑地址为0000H:0001H

逻辑地址 = 段地址:偏移地址


例:

设逻辑地址为1111H:2222H

则物理地址为:1111H * 10H + 2222H = 13332H


*内存分配方法*:根据实际运行的程序,代码段,数据段,堆栈的大小,以节为最小单位分配内存区域.16字节为1节.


例:

某一程序的长度为1020字节,操作数占510字节,堆栈段大约用250字节在定义时将代码长度定为1024D = 400H, 数据长度为512D = 200H,堆栈长度为256D = 100H.

假设系统给程序分配的内从区从那个6100H开始,则代码起始地址为6100H,代码段的偏移地址为0000 - 03FFH,即代码段的长度为400H,数据段的起始长度为6140H,数据的偏移地址为0000 - 01FFH,即数据段长度为200H,堆栈起始地址为6160H,段的偏移地址为0000 - 00FFH,长度为100H.

ps:段与段之间是可以部分重叠的.

*保护模式*:保护模式的使用要求程序员在程序中指定逻辑地址,机器采用另一种间接的方法得到相应的物理地址.保护模式下,逻辑地址由选择符和偏移地址两部分组成.在保护模式下,段寄存器存放当前正在运行程序的段选择符,通过段描述   符中的描述符间接地址形成段基地址,加上偏移地址得到最终的线性地址,此时对于存储器来输欧不必分段就可以访问到所有的 内存地址.

*描述符*:在32位CPU内有6个段寄存器,在实模式下直接存放的是段地址,在保护模式下存放的是段的选择符,它通过选择描述符表中的描述符,间接得到32位的段基地址.(段基地址即段的起始地址)

段和页的概念在操作系统课程笔记中有详细记录,不赘述.

===
